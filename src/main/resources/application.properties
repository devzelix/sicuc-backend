# ===================================================================
# == CORE APPLICATION CONFIGURATION
# ===================================================================

# Defines the name of the application (e.g., in logs and Spring Actuator)
spring.application.name=sicuc-backend

# Defines the active Spring profile (e.g., "dev", "prod").
# This is injected from an environment variable (e.g., dev, prod).
spring.profiles.active=${SPRING_PROFILES_ACTIVE}

# --- Server Configuration ---
server.port=8080

# Sets the base URL path for the API (e.g., /api/v1).
# Injected from an environment variable.
server.servlet.context-path=${API_BASE_PATH}

# Imports external configuration (like .env files) to resolve ${...} placeholders.
# "optional:" ensures the app doesn't fail if the .env file is missing
# (e.g., in a production container where variables are injected directly).
spring.config.import=optional:file:.env[.properties]


# ===================================================================
# == DATABASE (JPA & HIBERNATE) CONFIGURATION
# ===================================================================

# --- Datasource (Injected from Environment) ---
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# --- Hibernate Configuration ---
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# Controls the schema generation (DDL).
# "validate": (Recommended for Prod) Fails if the schema doesn't match entities.
# "update":   (Recommended for Dev) Attempts to update the schema.
# "none":     (Used by Flyway) Flyway handles all DDL.
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO}

# (CRITICAL) Disables the "Open Session in View" pattern.
# This prevents lazy-loading exceptions and improves performance by ensuring
# all DB queries are finished before the controller method returns.
spring.jpa.open-in-view=false


# ===================================================================
# == JWT SECURITY CONFIGURATION
# ===================================================================
# Injected from environment variables.
application.security.jwt.secret-key=${JWT_SECRET_KEY}
application.security.jwt.access-token.expiration=${JWT_ACCESS_TOKEN_EXPIRATION}
application.security.jwt.refresh-token.expiration=${JWT_REFRESH_TOKEN_EXPIRATION}


# ===================================================================
# == LOGGING OPTIMIZATION
# ===================================================================

# Set the default logging level to INFO
logging.level.root=info

# Reduce noise by setting common Spring packages to WARN (only show problems)
logging.level.org.springframework.web=warn
logging.level.org.springframework.boot.autoconfigure=warn

# (CRITICAL) Silences the known "AuthenticationProvider" bean warning in Spring Security 6.
logging.level.org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer=error

# (Optional) Set to DEBUG to see all SQL queries (very noisy).
logging.level.org.hibernate.SQL=off